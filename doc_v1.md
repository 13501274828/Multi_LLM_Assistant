# Multi-LLM 讨论与总结助手 PRD（v1）

## 0. 文档信息
- 文档版本：v1.0
- 文档类型：产品需求文档（PRD）
- 当前阶段：MVP 定义完成，可进入设计与研发拆解
- 产品形态：Web 优先（后续可扩展 App）

## 1. 一句话定位
一个让用户先把问题问准、再让多个大模型公开讨论、最后输出可执行结论的智能决策助手。

## 2. 背景与问题
用户在提问和决策时，普遍存在以下问题：
- 输入模糊：缺少背景、约束、目标、优先级。
- 问题不准：概念混淆、信息缺失、边界不清。
- 单模型偏差：答案看似合理，但视角单一、难验证。
- 结论不透明：用户不知道“为什么得出这个结果”。

这导致用户很难得到稳定、高可信、可执行的答案。

## 3. 产品目标
### 3.1 愿景
让“提出好问题 + 得到更可靠答案”成为低门槛操作。

### 3.2 MVP 目标
- 提升问题质量：把原始输入转成结构化 Problem Spec。
- 提升答案可信度：通过多模型对话形成共识与分歧。
- 提升可读性：让用户看得见讨论过程与来源依据。
- 控制成本：在用户可接受的延迟和预算下完成完整链路。

### 3.3 成功指标（MVP）
- 暂时不需要成功指标

## 4. 目标用户与核心场景
### 4.1 目标用户（MVP）
通用 C 端用户，重点覆盖：
- 需要做复杂选择但信息不完整的人
- 需要对一个问题进行多角度分析的人
- 需要“看过程而非只看答案”的人

### 4.2 核心场景
- 决策场景：职业选择、学习路径、购买决策。
- 内容场景：选题分析、方案对比、文章结构优化。
- 研究场景：观点对立问题的快速梳理与总结。

## 5. 核心价值主张
- 问题先精炼：先把问题定义清楚，再开始回答。
- 多方讨论：至少 3 个模型相互补强与挑战。
- 结果可追溯：每个结论都可回看来源模型和轮次。
- 可执行输出：最终总结能直接落地，而非泛泛而谈。

## 6. MVP 功能清单（P0）
### F01 输入区 + Plan Mode（Refiner）
目标：把用户的原始输入转成可讨论的问题定义。

功能点：
- 用户输入原始问题（自由文本）。
- Refiner 输出 `Problem Spec`，至少包含：
  - 目标（Goal）
  - 背景（Context）
  - 约束（Constraints）
  - 成功标准（Success Criteria）
- 用户需要再输入一轮prompts来作为最终的输入prompts

### F02 三模型讨论（Debate Panel）
目标：通过多模型、多轮互评提升结论完整性。

功能点：
- 默认 3 个 Debater 模型，支持切换“预设组合”。
- 默认 2 轮讨论（设置中可调整轮次上限）。
- Round 1：模型并行独立作答。
- Round 2+：每个模型读取“其他模型要点摘要 + 用户问题”后互评。
- 每轮要求：必须新增信息、反驳点或风险提示，禁止重复。

验收标准：
- 每轮输出都有明确新增点
- 模型输出可按轮次展开查看。

### F03 总结模型（Summarizer）
目标：将讨论产出整理为用户可执行结论。

功能点：
- Summarizer 输入：`Problem Spec + 各轮要点 + 关键分歧`。
- 输出结构（过程可读性优先）：
  - 讨论脉络摘要
  - 共识观点
  - 分歧观点
  - 最终建议

验收标准：
- 每条结论至少能映射到对应讨论来源。
- 对分歧问题不得强行合并为伪共识。

### F04 透明可追溯视图
目标：让用户理解“结论如何产生”。

功能点：
- 可视化模型辩论内容

### F05 成本与轮次控制
目标：让用户对成本和时延可预期、可控制。

功能点：
- 会话预算上限（Token/金额）配置。
- 最大轮次配置。
- 超预算降级策略（如减少轮次、压缩摘要、提示用户确认继续）。

验收标准：
- 达到阈值时系统稳定降级且给出清晰提示。

### F06 会话管理
目标：支持回溯、复用与分享结果。

功能点：
- 历史会话列表。
- 会话详情回看（输入、Refine、讨论、总结）。
- 一键重跑（保持配置或更换预设）。
- 复制与导出（Markdown / 纯文本）。

验收标准：
- 历史会话可检索、可回看、可重跑。

### F07 设置页（预设模型组合）
目标：在可控复杂度内提供模型灵活性。

功能点：
- 预设组合切换（示例：平衡型、创意型、严谨型）。
- 轮次、输出风格、预算上限设置。
- 是否跳过 Plan Mode（直接讨论模式）。

验收标准：
- 用户可在不理解底层模型细节的前提下完成配置。

## 7. 非 MVP 范围（P1/P2）
- 完全自定义模型编排（预设几个debate模型 用户可以选择）。
- 外部检索与证据校验（RAG）。
- 团队协作、共享链接、评论协同。
- 原生 iOS/Android App。

## 8. 用户流程（User Journey）
### 8.1 主流程（默认）
1. 用户输入原始问题。
2. Refiner 生成 `Problem Spec`。
3. 用户确认或编辑后点击“开始讨论”。
4. Debaters 进行多轮讨论，用户可展开每轮查看。
5. Summarizer 生成最终报告。
6. 用户复制、导出或重跑会话。

### 8.2 快速入口
1. 用户选择“直接讨论（跳过 Plan Mode）”。
2. 系统使用轻量问题清洗后直接进入 Debate。

## 9. 页面与信息架构（Web）
### 9.1 首页 / 新建会话
- 输入框
- 快捷模板（可选）
- 入口按钮：`进入 Plan Mode`、`直接讨论`

### 9.2 会话详情页（核心）
- 左侧：问题与配置（原始问题、Problem Spec、预算/轮次）
- 中部：讨论时间线（按轮次和模型展示）
- 右侧：总结报告（共识/分歧/建议/下一步）

### 9.3 历史会话列表
- 按时间、主题、状态筛选
- 支持重跑、复制、删除

### 9.4 设置页
- 预设模型组合
- 轮次和预算
- 输出风格偏好

## 10. 模型编排与执行规则
### 10.1 角色定义
- Refiner：将输入转为 `Problem Spec` 与讨论提示词。
- Debater A/B/C：不同推理风格的讨论模型。
- Summarizer：生成结构化最终输出。

### 10.2 编排顺序（默认）
1. Refiner 执行并产出 `Problem Spec`。
2. Debater A/B/C 并行执行 Round 1。
3. Round 2~N：每个 Debater 获取“其他模型要点摘要 + 用户问题”，继续互评。
4. Summarizer 聚合全部轮次要点并输出总结。

### 10.3 关键规则
- 每轮输出必须新增信息或有效反驳。
- 长文本喂给下一轮时仅传“要点摘要”，避免上下文爆炸。
- 对冲突结论必须显式标注，不允许静默覆盖。

## 11. 数据结构草案
### 11.1 Session
- `session_id`
- `user_input`
- `problem_spec`
- `config`
- `status`
- `created_at`
- `updated_at`

### 11.2 ProblemSpec
- `goal`
- `context`
- `constraints`
- `success_criteria`
- `unknowns`

### 11.3 DebateMessage
- `round`
- `model_id`
- `claims`
- `new_points`
- `rebuttals`
- `risks`

### 11.4 SummaryReport
- `process_summary`
- `consensus_items`
- `divergence_items`
- `final_recommendation`
- `next_actions`
- `citations`

## 12. API 草案（MVP）
- `POST /sessions`：创建会话
- `POST /sessions/{id}/refine`：生成/更新 Problem Spec
- `POST /sessions/{id}/debate/start`：启动讨论
- `POST /sessions/{id}/debate/next`：推进下一轮
- `POST /sessions/{id}/summarize`：生成总结
- `POST /sessions/{id}/rerun`：重跑会话
- `GET /sessions/{id}`：查询会话详情

## 13. 非功能需求
- 性能：单轮模型响应超时可配置，默认 20 秒。
- 稳定性：单模型失败不导致整体会话失败，支持降级继续。
- 安全性：对违规、敏感输入执行拦截与安全提示。
- 可观测性：记录每轮耗时、Token、错误码、成功率。

## 14. 验收标准（MVP）
- 输入模糊时，Refiner 可生成结构化问题定义。
- 三模型讨论至少形成 1 组明确分歧和 1 组共识。
- 总结内容可映射到具体模型发言来源。
- 预算触发时可执行降级且不崩溃。
- 历史会话可回看、可重跑、可导出。

## 15. 版本路线图
### MVP（当前）
- Web 端
- Refiner + 3 Debaters + Summarizer
- 预设模型组合切换
- 会话管理与导出

### V1.1
- 支持 4 Debaters 模式
- 更丰富的总结模板（学习/决策/创作）
- 更强的重复检测与分歧聚合

### V1.2
- 引入外部检索（RAG）与引用校验
- 团队协作与分享能力
- App 端规划与同步

## 16. 风险与缓解
- 风险：多模型成本过高。
  - 缓解：预算阈值 + 动态降级 + 摘要压缩。
- 风险：讨论内容冗长、重复。
  - 缓解：强制“新增信息”约束 + 重复检测。
- 风险：用户不理解结果可信度。
  - 缓解：共识/分歧可视化 + 来源追溯。
r
## 17. 结论
该版本已满足 MVP 立项要求：范围清晰、流程清晰、角色清晰、验收清晰。可直接进入 UI 设计、后端编排实现、提示词工程与灰度测试。
